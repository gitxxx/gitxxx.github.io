<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="大数据、信息安全、数据挖掘、树莓派"><title>Spark Streaming更新offset到zk | fangbb的博客</title><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/4.2.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/0.6.0/grids-responsive-min.css"><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="/css/donate.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.0.0/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Spark Streaming更新offset到zk</h1><a id="logo" href="/.">fangbb的博客</a><p class="description">得之我幸,失之我命</p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div id="layout" class="pure-g"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Spark Streaming更新offset到zk</h1><div class="post-meta">Apr 30, 2017<span> | </span><span class="category"><a href="/categories/流处理/">流处理</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span></div><div class="clear"><div id="toc" class="toc-article"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#介绍"><span class="toc-number">1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#通过KafkaCluster实现"><span class="toc-number">2.</span> <span class="toc-text">通过KafkaCluster实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#通过ZkUtils实现"><span class="toc-number">3.</span> <span class="toc-text">通过ZkUtils实现</span></a></li></ol></div></div><div class="post-content"><h1 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h1><p>Direct利用Kafka的low-level API从Kafka集群中读取数据，通过checkpoint维护offset信息，导致Kafka manager失效（那些基于zk获取offset的Kafka集群监控软件都会失效）。</p>
<p><strong>更新offset到zk方法:</strong><br>方法一：通过KafkaCluster实现<br>方法二：通过ZkUtils实现</p>
<p><strong>更新offset时机:</strong><br>方法一：通过事件监听实现，调用streamingContext的addStreamingListener()方法，batch结束时触发<br>方法二：处理完每个RDD后的顺序保存</p>
<h1 id="通过KafkaCluster实现"><a href="#通过KafkaCluster实现" class="headerlink" title="通过KafkaCluster实现"></a>通过KafkaCluster实现</h1><p>与Kafka集群交互的便捷方法。有关各个API调用的更多详细信息，请参阅<a href="https://cwiki.apache.org/confluence/display/KAFKA/A+Guide+To+The+Kafka+Protocol" target="_blank" rel="noopener">Kafka协议指南</a>。使用host1:port1,host2:port2格式设置”metadata.broker.list”或”bootstrap.servers”指定的Kafka代理（而非zookeeper服务器）</p>
<ol>
<li><p>获取offset<br>offset可通过HasOffsetRanges类的offsetRanges获取</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">val offsetsList = rdd<span class="selector-class">.asInstanceOf</span>[HasOffsetRanges].offsetRanges</span><br></pre></td></tr></table></figure>
</li>
<li><p>读取offset<br>调用KafkaCluster类的getConsumerOffsets方法获取offset</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">def</span> <span class="selector-tag">getConsumerOffsets</span>(<span class="attribute">groupId</span>: String, <span class="attribute">topicAndPartitions</span>: Set[TopicAndPartition], <span class="attribute">consumerApiVersion</span>: Short): <span class="selector-tag">Either</span><span class="selector-attr">[KafkaCluster.Err, Map[TopicAndPartition, Long]</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新offset<br>调用KafkaCluster类的setConsumerOffsets方法去更新Zookeeper</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">def</span> <span class="selector-tag">setConsumerOffsets</span>(<span class="attribute">groupId</span>: String, <span class="attribute">offsets</span>: Map[TopicAndPartition, Long], <span class="attribute">consumerApiVersion</span>: Short): <span class="selector-tag">Either</span><span class="selector-attr">[KafkaCluster.Err, Map[TopicAndPartition, Short]</span>]</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>代码：<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> kc = new KafkaCluster(kafkaParams)</span><br><span class="line">def getConsumerOffsets(topics: Set[String]): Map[TopicAndPartition, <span class="built_in">Long</span>] = &#123;</span><br><span class="line">  <span class="keyword">val</span> groupId = kafkaParams.<span class="keyword">get</span>(<span class="string">"group.id"</span>).<span class="keyword">get</span></span><br><span class="line">  <span class="keyword">val</span> partitionsE = kc.getPartitions(topics)</span><br><span class="line">  <span class="keyword">if</span> (partitionsE.isLeft)&#123;</span><br><span class="line">    <span class="keyword">val</span> err = s<span class="string">"get kafka partition failed: <span class="subst">$&#123;partitionsE.left.get&#125;</span> for topics "</span> + topics</span><br><span class="line">    logger.error(err)</span><br><span class="line">    <span class="keyword">throw</span> new SparkException(err)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">val</span> partitions = partitionsE.right.<span class="keyword">get</span></span><br><span class="line">  <span class="keyword">val</span> consumerOffsetsE = kc.getConsumerOffsets(groupId, partitions, consumerApiVersion)</span><br><span class="line">  <span class="keyword">if</span> (consumerOffsetsE.isLeft)&#123;</span><br><span class="line">    <span class="keyword">val</span> err = s<span class="string">"get kafka consumer offsets failed: <span class="subst">$&#123;consumerOffsetsE.left.get&#125;</span> for group "</span> + groupId</span><br><span class="line">    logger.error(err)</span><br><span class="line">    <span class="keyword">throw</span> new SparkException(err)</span><br><span class="line">  &#125;</span><br><span class="line">  consumerOffsetsE.right.<span class="keyword">get</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">def saveKafkaOffset(offset: Map[TopicAndPartition, <span class="built_in">Long</span>]) : <span class="built_in">Unit</span> = &#123;</span><br><span class="line">  <span class="keyword">val</span> groupId = kafkaParams.<span class="keyword">get</span>(<span class="string">"group.id"</span>).<span class="keyword">get</span></span><br><span class="line">  <span class="keyword">val</span> o = kc.setConsumerOffsets(groupId, offset, consumerApiVersion)</span><br><span class="line">  <span class="keyword">if</span> (o.isLeft) &#123;</span><br><span class="line">    logger.error(s<span class="string">"Error updating the offset to Kafka cluster: <span class="subst">$&#123;o.left.get&#125;</span> for group "</span> + groupId + <span class="string">" "</span> + offset)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="通过ZkUtils实现"><a href="#通过ZkUtils实现" class="headerlink" title="通过ZkUtils实现"></a>通过ZkUtils实现</h1><ol>
<li><p>获取offset<br>同样通过HasOffsetRanges类的offsetRanges获取</p>
</li>
<li><p>读取offset</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ZkUtils</span><span class="selector-class">.readDataMaybeNull</span>(zkClient, zkOffsetPath) <span class="comment">//从zk上读取偏移量</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>更新offset</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">ZkUtils</span><span class="selector-class">.updatePersistentPath</span>(<span class="selector-tag">zkClient</span>, <span class="selector-tag">zkOffsetPath</span>, <span class="selector-tag">offsetsRangesStr</span>)</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>代码：<br><figure class="highlight dart"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line">object KafkaOffsetManager &#123;</span><br><span class="line">  lazy val log = org.apache.log4j.LogManager.getLogger(<span class="string">"KafkaOffsetManage"</span>)</span><br><span class="line">  <span class="comment"><span class="markdown">/<span class="emphasis">** *</span>读取zk里面的偏移量，如果有就返回对应的分区和偏移量</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>如果没有就返回None</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">    *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param zkClient     zk连接的client</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param zkOffsetPath 偏移量路径</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param topic        topic名字</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@return 偏移量Map or None</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">    */</span></span></span></span><br><span class="line">  def readOffsets(zkClient: ZkClient, zkOffsetPath: <span class="built_in">String</span>, topic: <span class="built_in">String</span>): Option[<span class="built_in">Map</span>[TopicAndPartition, Long]] = &#123;</span><br><span class="line">    <span class="comment">//存储在zk中当前offset状态</span></span><br><span class="line">	<span class="comment">//（偏移量字符串,zk元数据)</span></span><br><span class="line">    val (offsetsRangesStrOpt, _) = ZkUtils.readDataMaybeNull(zkClient, zkOffsetPath) <span class="comment">//从zk上读取偏移量</span></span><br><span class="line">    offsetsRangesStrOpt match &#123;</span><br><span class="line">      <span class="keyword">case</span> Some(offsetsRangesStr) =&gt;</span><br><span class="line">        <span class="comment">//这个topic在zk里面最新的分区数量</span></span><br><span class="line">        val lastest_partitions = ZkUtils.getPartitionsForTopics(zkClient, Seq(topic)).<span class="keyword">get</span>(topic).<span class="keyword">get</span></span><br><span class="line">        <span class="keyword">var</span> offsets = offsetsRangesStr.split(<span class="string">","</span>) <span class="comment">//按逗号split成数组</span></span><br><span class="line">          .map(s =&gt; s.split(<span class="string">":"</span>)) <span class="comment">//按冒号拆分每个分区和偏移量</span></span><br><span class="line">          .map &#123; <span class="keyword">case</span> Array(partitionStr, offsetStr) =&gt; (TopicAndPartition(topic, partitionStr.toInt) -&gt; offsetStr.toLong) &#125; <span class="comment">//加工成最终的格式</span></span><br><span class="line">          .toMap <span class="comment">//返回一个Map</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">//说明有分区扩展了</span></span><br><span class="line">        <span class="keyword">if</span> (offsets.size &lt; lastest_partitions.size) &#123;</span><br><span class="line">          <span class="comment">//得到旧的所有分区序号</span></span><br><span class="line">          val old_partitions = offsets.keys.map(p =&gt; p.partition).toArray</span><br><span class="line">          <span class="comment">//通过做差集得出来多的分区数量数组</span></span><br><span class="line">          val add_partitions = lastest_partitions.diff(old_partitions)</span><br><span class="line">          <span class="keyword">if</span> (add_partitions.size &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            log.warn(<span class="string">"发现kafka新增分区："</span> + add_partitions.mkString(<span class="string">","</span>))</span><br><span class="line">            add_partitions.foreach(partitionId =&gt; &#123;</span><br><span class="line">              offsets += (TopicAndPartition(topic, partitionId) -&gt; <span class="number">0</span>)</span><br><span class="line">              log.warn(<span class="string">"新增分区id："</span> + partitionId + <span class="string">"添加完毕...."</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          log.warn(<span class="string">"没有发现新增的kafka分区："</span> + lastest_partitions.mkString(<span class="string">","</span>))</span><br><span class="line">        &#125;</span><br><span class="line">        Some(offsets) <span class="comment">//将Map返回</span></span><br><span class="line">      <span class="keyword">case</span> None =&gt;</span><br><span class="line">        None <span class="comment">//如果是null，就返回None</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment"><span class="markdown">/<span class="strong">** **</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>保存每个批次的rdd的offset到zk中</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">    *</span></span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param zkClient     zk连接的client</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param zkOffsetPath 偏移量路径</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="bullet">    * </span>@param rdd          每个批次的rdd</span></span></span><br><span class="line"><span class="comment"><span class="markdown"><span class="code">    */</span></span></span></span><br><span class="line">  def saveOffsets(zkClient: ZkClient, zkOffsetPath: <span class="built_in">String</span>, rdd: RDD[_]): Unit = &#123;</span><br><span class="line">    <span class="comment">//转换rdd为Array[OffsetRange]</span></span><br><span class="line">    val offsetsRanges = rdd.asInstanceOf[HasOffsetRanges].offsetRanges</span><br><span class="line">    <span class="comment">//转换每个OffsetRange为存储到zk时的字符串格式 :  分区序号1:偏移量1,分区序号2:偏移量2,......</span></span><br><span class="line">    val offsetsRangesStr = offsetsRanges.map(offsetRange =&gt; s<span class="string">"<span class="subst">$&#123;offsetRange.partition&#125;</span>:<span class="subst">$&#123;offsetRange.untilOffset&#125;</span>"</span>).mkString(<span class="string">","</span>)</span><br><span class="line">    log.debug(<span class="string">" 保存的偏移量：  "</span> + offsetsRangesStr)</span><br><span class="line">    <span class="comment">//将最终的字符串结果保存到zk里面</span></span><br><span class="line">    ZkUtils.updatePersistentPath(zkClient, zkOffsetPath, offsetsRangesStr)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Stopwatch</span> </span>&#123;</span><br><span class="line">    private val start = System.currentTimeMillis()</span><br><span class="line">    def <span class="keyword">get</span>(): Long = (System.currentTimeMillis() - start)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>处理offset时应该关注三个时刻的offset的情况：<br>1）<strong>首次启动时</strong><br>auto.offset.reset应设为<strong>smallest</strong>。<br>auto.offset.reset定义了Consumer在ZooKeeper中发现没有初始的offset时或者发现offset非法时定义Comsumer的行为，常见的配置有：<br>1 smallest : 自动把offset设为最小的offset；<br>2 largest : 自动把offset设为最大的offset；<br>3 anything else: 抛出异常；</p>
<p>2）<strong>停止并再次启动时</strong><br>应先读取已保存在外部的offset值，从上次结束时的偏移量开始继续消费数据。</p>
<p>3）<strong>Kafka增加分区后，应重启application</strong><br>使用direct方式接收Kafka中数据时，partition是1:1的，但是Kafka可以通过命令动态添加partition，而application并不能自动识别增加的partition，应重启Spark Streaming的application。</p>
<p>参考：<br><a href="http://spark.apache.org/docs/2.0.1/api/java/org/apache/spark/streaming/kafka/KafkaCluster.html" target="_blank" rel="noopener">KafkaCluster API</a><br><a href="https://www.iteblog.com/archives/1381.html" target="_blank" rel="noopener">Spark+Kafka的Direct方式将偏移量发送到Zookeeper实现</a><br><a href="https://www.cnblogs.com/xlturing/p/6246538.html" target="_blank" rel="noopener">Spark Streaming+Kafka</a><br><a href="https://github.com/xlturing/spark-journey/tree/master/SparkStreamingKafka" target="_blank" rel="noopener">SparkStreamingKafka</a><br><a href="https://github.com/qindongliang/streaming-offset-to-zk/blob/master/src/main/scala/KafkaOffsetManager.scala" target="_blank" rel="noopener">streaming-offset-to-zk</a><br><a href="https://kafka.apache.org/0101/documentation.html" target="_blank" rel="noopener">Kafka documentation</a><br><a href="https://www.cnblogs.com/huxi2b/p/6061110.html" target="_blank" rel="noopener">Kafka 如何读取offset topic内容 (__consumer_offsets)</a></p>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a data-url="http://fangbinbin.com/2017/04/30/Spark Streaming更新offset到zk/" data-id="cjxy7e2lr001ygsi2c0ghg3dr" class="article-share-link">分享到</a><div class="tags"><a href="/tags/Kafka/">Kafka</a><a href="/tags/Spark-Streaming/">Spark Streaming</a></div><div class="post-nav"><a href="/2017/05/08/NLP之分词/" class="pre">NLP之分词</a><a href="/2017/04/29/Spark Streaming优雅关闭/" class="next">Spark Streaming优雅关闭</a></div><div class="post-donate"><div id="donate_board" class="donate_bar center"><a id="btn_donate" href="javascript:;" title="打赏" class="btn_donate"></a><div class="donate_txt"> &uarr;<br>此文有用? 求鼓励!<br></div></div><div id="donate_guide" class="donate_bar center hidden"><img src="/images/wxzf.jpg" title="微信打赏"></div><script type="text/javascript">document.getElementById('btn_donate').onclick = function(){
    $('#donate_board').addClass('hidden');
    $('#donate_guide').removeClass('hidden');
}</script></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form action="//www.baidu.com/baidu" method="get" accept-charset="utf-8" target="_blank" class="search-form"><input type="search" name="word" maxlength="20" placeholder="Search"><input type="hidden" name="si" value="http://fangbinbin.com"><input name="tn" type="hidden" value="bds"><input name="cl" type="hidden" value="3"><input name="ct" type="hidden" value="2097152"><input name="s" type="hidden" value="on"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/ES/">ES</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/">NLP</a><span class="category-list-count">6</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/NLP/知识图谱/">知识图谱</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spark/">Spark</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/指导/">指导</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/机器学习/">机器学习</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/杂谈/">杂谈</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/流处理/">流处理</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/系统/">系统</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/">编程</a><span class="category-list-count">3</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/编程/爬虫/">爬虫</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程/语言/">语言</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/编程语言/">编程语言</a><span class="category-list-count">1</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/ES/" style="font-size: 22.5px;">ES</a> <a href="/tags/Java/" style="font-size: 15px;">Java</a> <a href="/tags/Kafka/" style="font-size: 25px;">Kafka</a> <a href="/tags/ML/" style="font-size: 20px;">ML</a> <a href="/tags/MLeap/" style="font-size: 17.5px;">MLeap</a> <a href="/tags/NLP/" style="font-size: 25px;">NLP</a> <a href="/tags/Markdown/" style="font-size: 15px;">Markdown</a> <a href="/tags/特征/" style="font-size: 15px;">特征</a> <a href="/tags/网站/" style="font-size: 15px;">网站</a> <a href="/tags/爬虫/" style="font-size: 15px;">爬虫</a> <a href="/tags/登陆/" style="font-size: 15px;">登陆</a> <a href="/tags/Spark/" style="font-size: 20px;">Spark</a> <a href="/tags/Spark-Streaming/" style="font-size: 25px;">Spark Streaming</a> <a href="/tags/技能图谱/" style="font-size: 15px;">技能图谱</a> <a href="/tags/系统/" style="font-size: 15px;">系统</a> <a href="/tags/虚拟机/" style="font-size: 15px;">虚拟机</a> <a href="/tags/杂谈/" style="font-size: 15px;">杂谈</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最新文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2019/04/24/MLeap实例篇/">MLeap实例篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/01/MLeap使用篇/">MLeap使用篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/29/MLeap介绍篇/">MLeap介绍篇</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/03/20/Spark ML Pipelines/">Spark ML Pipelines</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/05/31/记忆力杂谈/">记忆力杂谈</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/03/11/Java之新特性/">Java之新特性</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/10/NLP之知识图谱/">NLP之知识图谱</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/08/10/NLP之应用场景/">NLP之应用场景</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/08/NLP之命名实体识别/">NLP之命名实体识别</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/08/NLP之分词/">NLP之分词</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://www.baidu.com/" title="百度搜索" target="_blank">百度搜索</a><ul></ul><a href="http://www.google.com/" title="谷歌搜索" target="_blank">谷歌搜索</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">© <a href="/." rel="nofollow">fangbb的博客.</a> Powered by<a rel="nofollow" target="_blank" href="https://fangbinbin.com"> fangbb.</a><br>
<script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1260773095'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1260773095%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script></div></div></div><a id="rocket" href="#top" class="show"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="/css/jquery.fancybox.css?v=0.0.0"><script type="text/javascript">var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cspan id='cnzz_stat_icon_1260773095'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "s95.cnzz.com/z_stat.php%3Fid%3D1260773095%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>